/**
 * Pixel Art Assets - Shared character sprites and color palettes
 * Used by both the replay viewer and the live dashboard.
 */

// Pixel art SVG characters (16x16 grid, displayed at 64x64)
function createPixelSVG(pixels, palette) {
  const size = 4; // each pixel = 4x4 in SVG
  let rects = '';
  for (let y = 0; y < pixels.length; y++) {
    for (let x = 0; x < pixels[y].length; x++) {
      const colorIdx = pixels[y][x];
      if (colorIdx === 0) continue; // transparent
      const color = palette[colorIdx] || '#000';
      rects += `<rect x="${x * size}" y="${y * size}" width="${size}" height="${size}" fill="${color}"/>`;
    }
  }
  return `data:image/svg+xml,${encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" shape-rendering="crispEdges">${rects}</svg>`)}`;
}

// Color palettes for each role
const P = {
  merlin: { 1: '#3b5dc9', 2: '#41a6f6', 3: '#f4f4f4', 4: '#ffcd75', 5: '#94b0c2', 6: '#1a1c2c', 7: '#73eff7' },
  percival: { 1: '#94b0c2', 2: '#566c86', 3: '#f4f4f4', 4: '#3b5dc9', 5: '#41a6f6', 6: '#1a1c2c', 7: '#ffcd75' },
  servant: { 1: '#8b6d4c', 2: '#566c86', 3: '#f4f4f4', 4: '#94b0c2', 5: '#3b5dc9', 6: '#1a1c2c', 7: '#a7f070' },
  morgana: { 1: '#5d275d', 2: '#b13e53', 3: '#f4f4f4', 4: '#ef7d57', 5: '#73eff7', 6: '#1a1c2c', 7: '#ffcd75' },
  assassin: { 1: '#333c57', 2: '#1a1c2c', 3: '#b13e53', 4: '#ef7d57', 5: '#f4f4f4', 6: '#1a1c2c', 7: '#566c86' },
  unknown: { 1: '#566c86', 2: '#333c57', 3: '#94b0c2', 4: '#f4f4f4', 5: '#566c86', 6: '#1a1c2c' },
};

// 16x16 pixel art definitions (0 = transparent)
const PIXEL_ART = {
  // Merlin: Blue wizard with pointed hat, white beard, staff
  merlin: [
    [0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,4,4,4,4,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,7,7,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0],
    [0,0,0,0,3,5,6,6,5,3,0,0,0,0,0,0],
    [0,0,0,0,3,3,3,3,3,3,0,0,0,0,0,0],
    [0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0],
    [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
    [0,0,0,0,1,1,2,2,1,1,0,0,0,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0],
    [0,0,0,0,2,2,0,0,2,2,0,0,0,0,0,0],
  ],
  // Percival: Silver knight with helmet and sword
  percival: [
    [0,0,0,0,0,0,7,7,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,7,4,4,7,0,0,0,0,0,0,0],
    [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,3,6,3,3,6,3,0,0,0,0,0,0],
    [0,0,0,0,3,3,3,3,3,3,0,0,0,0,0,0],
    [0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0],
    [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,1,1,1,4,4,1,1,1,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,0,2,1,1,2,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0],
    [0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0],
    [0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0],
  ],
  // Loyal servant: Simple soldier with brown tunic
  servant: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,3,6,3,3,6,3,0,0,0,0,0,0],
    [0,0,0,0,3,3,3,3,3,3,0,0,0,0,0,0],
    [0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0],
    [0,0,0,0,0,4,4,4,4,0,0,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0],
    [0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0],
    [0,0,0,0,0,1,2,2,1,0,0,0,0,0,0,0],
    [0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0],
    [0,0,0,0,2,2,0,0,2,2,0,0,0,0,0,0],
  ],
  // Morgana: Purple sorceress with crown, flowing robes
  morgana: [
    [0,0,0,0,0,0,7,7,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,7,5,5,7,0,0,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0],
    [0,0,0,0,3,6,3,3,6,3,0,0,0,0,0,0],
    [0,0,0,0,3,3,2,2,3,3,0,0,0,0,0,0],
    [0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0],
    [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
    [0,0,0,0,1,1,2,2,1,1,0,0,0,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
    [0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0],
    [0,0,0,0,2,2,0,0,2,2,0,0,0,0,0,0],
  ],
  // Assassin: Dark hooded figure with dagger
  assassin: [
    [0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0],
    [0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0],
    [0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0],
    [0,0,0,0,5,3,7,7,3,5,0,0,0,0,0,0],
    [0,0,0,0,7,7,7,7,7,7,0,0,0,0,0,0],
    [0,0,0,0,0,7,7,7,7,0,0,0,0,0,0,0],
    [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,3,0,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,3,3,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,3,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0],
    [0,0,0,0,2,2,0,0,2,2,0,0,0,0,0,0],
  ],
  // Unknown: Gray silhouette with question mark
  unknown: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
    [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
    [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
    [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
    [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
    [0,0,0,0,0,1,2,2,1,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0],
    [0,0,0,2,2,2,4,4,2,2,2,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0],
    [0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0],
    [0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0],
    [0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0],
  ],
};

// Pre-generate SVG data URIs for all characters
const CHARACTER_IMAGES = {
  merlin: createPixelSVG(PIXEL_ART.merlin, P.merlin),
  percival: createPixelSVG(PIXEL_ART.percival, P.percival),
  loyal_servant_1: createPixelSVG(PIXEL_ART.servant, P.servant),
  loyal_servant_2: createPixelSVG(PIXEL_ART.servant, P.servant),
  morgana: createPixelSVG(PIXEL_ART.morgana, P.morgana),
  assassin: createPixelSVG(PIXEL_ART.assassin, P.assassin),
  unknown: createPixelSVG(PIXEL_ART.unknown, P.unknown),
};
