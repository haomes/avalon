<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Avalon Replay Viewer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div id="app">
    <!-- 加载界面 -->
    <div id="loader-screen">
      <div class="loader-box pixel-border">
        <h1 class="loader-title">AVALON</h1>
        <p class="loader-subtitle">Multi-Agent Replay Viewer</p>
        <div class="loader-divider"></div>
        <label for="replay-file" class="pixel-btn loader-btn">
          LOAD REPLAY FILE
        </label>
        <input type="file" id="replay-file" accept=".json" hidden>
        <p class="loader-hint">Select a replay_*.json file to start</p>
      </div>
    </div>

    <!-- 主游戏界面 -->
    <div id="game-screen" class="hidden">
      <!-- 顶部标题栏 -->
      <header id="header" class="pixel-border">
        <div class="header-left">
          <span class="header-logo">AVALON</span>
          <span class="header-label">REPLAY</span>
        </div>
        <div class="header-right">
          <button id="load-new-btn" class="pixel-btn pixel-btn-sm" title="Load another replay">NEW</button>
          <button id="god-mode-btn" class="pixel-btn pixel-btn-sm" title="Toggle God Mode (G)">
            <span class="god-eye">&#x1F441;</span> GOD MODE: <span id="god-mode-status">OFF</span>
          </button>
        </div>
      </header>

      <!-- 游戏信息栏 -->
      <div id="info-bar" class="pixel-border">
        <span id="round-info">Round: -/-</span>
        <span id="score-info">
          <span class="good-text">GOOD 0</span>
          <span class="score-sep">:</span>
          <span class="evil-text">0 EVIL</span>
        </span>
        <span id="mission-size-info">Team Size: -</span>
      </div>

      <!-- 玩家圆桌区域 -->
      <div id="player-area">
        <div id="player-circle">
          <!-- 6 player cards generated by JS -->
        </div>
        <div id="round-table">
          <div class="table-inner">
            <span id="table-phase-label">ROUND TABLE</span>
          </div>
        </div>
      </div>

      <!-- 阶段导航 -->
      <div id="phase-nav" class="pixel-border">
        <button id="btn-first" class="pixel-btn pixel-btn-nav" title="First step">&lt;&lt;</button>
        <button id="btn-prev" class="pixel-btn pixel-btn-nav" title="Previous (Left Arrow)">&lt;</button>
        <button id="btn-play" class="pixel-btn pixel-btn-nav pixel-btn-play" title="Play/Pause (P)">&#9654;</button>
        <span id="phase-label">Loading...</span>
        <button id="btn-next" class="pixel-btn pixel-btn-nav" title="Next (Right Arrow / Space)">&gt;</button>
        <button id="btn-last" class="pixel-btn pixel-btn-nav" title="Last step">&gt;&gt;</button>
        <div id="speed-selector">
          <button class="pixel-btn pixel-btn-speed" data-speed="0.5">0.5x</button>
          <button class="pixel-btn pixel-btn-speed active" data-speed="1">1x</button>
          <button class="pixel-btn pixel-btn-speed" data-speed="2">2x</button>
          <button class="pixel-btn pixel-btn-speed" data-speed="3">3x</button>
        </div>
      </div>

      <!-- 详情面板 -->
      <div id="detail-panel" class="pixel-border">
        <div id="detail-content">
          <!-- Phase-specific content rendered here -->
        </div>
      </div>

      <!-- 时间轴 -->
      <div id="timeline" class="pixel-border">
        <div id="timeline-rounds">
          <!-- Round markers generated by JS -->
        </div>
      </div>
    </div>

    <!-- 隐藏的文件输入（用于重新加载） -->
    <input type="file" id="replay-file-new" accept=".json" hidden>
  </div>

  <script src="js/pixel-art.js"></script>
  <script src="js/replay-engine.js"></script>
  <script src="js/ui-renderer.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
